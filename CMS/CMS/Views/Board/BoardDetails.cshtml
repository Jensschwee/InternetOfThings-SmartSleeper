@using CMS.Models
@using Microsoft.CodeAnalysis.CSharp.Syntax
@model List<CMS.Models.SensorReadingModel>

<title>ViewData.title</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
<script src="http://d3js.org/d3.v3.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../js/jquery.tipsy.js"></script>
<link href="../css/tipsy.css" rel="stylesheet" type="text/css" />
<link href="../css/d3LineChart.css" rel="stylesheet" type="text/css" />

@if (Model != null)
{
    <div id="chart"></div>
}
else
{
    <span>
        <strong>
            THIS DEVICES IS NOT FOUND
        </strong>
    </span>
}
<script src="../js/d3LineChart.js" type="text/javascript"></script>

<script>
    var getTempFunktion = function generateData() {
        var data = [];
        @foreach (SensorReadingModel se in Model)
        {
            @:var date = new Date();
            @:date.setYear(@se.SensorTime.Year);
            @:date.setMonth(@se.SensorTime.Month-1);
            @:date.setDate(@se.SensorTime.Day);
            @:date.setHours(@se.SensorTime.Hour, @se.SensorTime.Minute, @se.SensorTime.Second, @se.SensorTime.Millisecond);
            @:data.push({ 'value': @se.temperature.ToString().Replace(",","."), 'date': date });
        }
        return data;
    }

    draw(getTempFunktion(), "#chart", "Temperature");
</script>